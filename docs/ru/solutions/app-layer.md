# Слой app

## Семантика

App — всё, благодаря чему приложение запускается. Самый верхний слой в луковичной архитектуре.

Место где мы:
1. Объявляем точку входа в приложение
2. Связываем модули в конкретную систему (роутинг)
3. Описываем глобальную конфигурацию (стили и тд)
4. Инициализируем и внедряем зависимости (DI)

#### Требования
- Не содержит бизнес-логику

#### Свойста
- Знает о всех абстракциях, под которые необходимо подбросить реализацию

## Когда использовать
Содержимое файла с точкой входа и настройкой приложения не помещается в 2 экрана и делится на смысловые блоки. Пример блоков:
- описание глобальной конфигурации  
- настройка конкретного плагина
- зона подключения нескольких плагинов

## Синтаксис
Структура папок:
```
src/
└── app/
    ├── plugins/           # Логика инициализации и настройки плагинов (в React providers)
    │   ├── router/
    │   │   ├── routes.ts
    |   |   └── index.ts
    │   ├── store.ts
    │   ├── tanstack-query.ts
    │   ├── vuetify.ts
    │   └── index.ts
    ├── styles/            # Глобальные стили
    │   ├── main.css       # Точка входа стилей
    │   ├── reset.css      # Сброс стилей
    │   └── variables.css  # CSS переменные/токены
    ├── types/             # Глобальные декларации типов (например, env.d.ts)
    │   └── global.d.ts
    ├── App.vue            # Корневой компонент
    └── main.ts            # Точка входа
```

Vite:
```html
<!-- index.html -->
<script type="module" src="/src/app/main.ts"></script>
```

## Автоматизация
Так как это самый верхний слой иерархии, то запрещаем импортировать из него что-либо.

## Несколько приложений из одной кодовой базы
::: tip
У одной кодовой базы может быть несколько различных приложений. Например: бизнес нашел нового заказчика, боли которого решаются определенной частью системы.
:::

### Пример если важен tree-shaking

Cтруктуры папок:
```
src/
└── apps/
    ├── <заказчик 1>/      # Важно использовать термины бизнеса для однозначности
    │   ├── ...
    │   └── main.ts
    ├── <заказчик 2>/
    │   ├── ...
    │   └── main.ts
    └── shared/            # Настройки, которые можно пошарить между приложениями, чтобы их не дублировать
        ├── ...
        └── index.ts       # Для удобства
```

Vite:
```html
<!-- index.html -->
<script type="module" src="%VITE_ENTRY_PATH%"></script>
```
Не забываем добавить `VITE_ENTRY_PATH` в `env`