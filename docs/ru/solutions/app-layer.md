# Слой app

## Семантика

Слой отвечает за:

- Инициализацию приложения (Bootstrapping) - точка входа (entry point) и монтирование приложения;
- Глобальную конфигурацию:
  - Централизованный роутинг - cвязываем страницы в конкретное приложение;
  - Глобальное состояние - конфигурируем хранилища (Stores) и механизмы управления данными;
  - Сетевой слой - конфигурируем API-клиентов;
  - Настройку ui-kit'a и стилей;
  - Мониторинг, аналитика, глобальная обработка исключений;
- Доставку глобальных конфигураций в модули приложения (Providers).

### Требования

- Не содержит бизнес-логику.

### Свойста

- Незнакомому с кодовой базой разработчику достаточно изучить данный слой, чтобы понять ключевой стек технологий, инфростуруктурную обвязку и способы взаимодействия с внешними системами;
- Знает о всех абстракциях, под которые необходимо подставить реализацию;
- Редко изменяется (исключение - роутинг).

## Когда использовать

Содержимое файла с точкой входа и настройкой приложения не помещается в 2 экрана и делится на смысловые блоки. Пример блоков:

- описание глобальной конфигурации;
- настройка конкретного плагина;
- зона подключения нескольких плагинов.

## Синтаксис

Структура папок:

```text
src/
└── app/
    ├── plugins/           # Логика инициализации и настройки плагинов (в React providers)
    │   ├── router/
    │   │   ├── routes.ts
    |   |   └── index.ts
    │   ├── store.ts
    │   ├── tanstack-query.ts
    │   ├── vuetify.ts
    │   └── index.ts
    ├── styles/            # Глобальные стили
    │   ├── main.css       # Точка входа стилей
    │   ├── reset.css      # Сброс стилей
    │   └── variables.css  # CSS переменные/токены
    ├── types/             # Глобальные декларации типов (например, env.d.ts)
    │   └── global.d.ts
    ├── App.vue            # Корневой компонент
    └── main.ts            # Точка входа
```

Vite:

```html
<!-- index.html -->
<script type="module" src="/src/app/main.ts"></script>
```

## Автоматизация

`TODO`

## Несколько приложений из одной кодовой базы

::: tip
У одной кодовой базы может быть несколько различных приложений. Например: бизнес нашел нового заказчика, боли которого решаются определенной частью системы.
:::

### Пример если важен tree-shaking

Cтруктуры папок:

```text
src/
└── apps/
    ├── <заказчик 1>/      # Важно использовать термины бизнеса для однозначности
    │   ├── ...
    │   └── main.ts
    ├── <заказчик 2>/
    │   ├── ...
    │   └── main.ts
    └── shared/            # Настройки, используемые в нескольких приложениях
        ├── ...
        └── index.ts       # Для удобства
```

Vite:

```html
<!-- index.html -->
<script type="module" src="%VITE_ENTRY_PATH%"></script>
```

Не забываем добавить `VITE_ENTRY_PATH` в `env`.
